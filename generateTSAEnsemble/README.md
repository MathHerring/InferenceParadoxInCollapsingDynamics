

## How to Generate Your TSA Ensemble

This script generates simulated time series and summary statistics for TSA stochastic models with power law-like force and noise (see manuscript for details) by calling an external C simulation. For each combination of model parameters (`gamma`, `D`, `alpha`, `beta`), the script:

- Calls the C binary `./generateTSAtrajectories/prog` with the specified parameters to simulate `nrealiz` trajectories up to a set time (`fit_until_this_t`). Further details for compilation can be found below.
- Loads summary output files generated by the C simulation: `num_mean.txt` (means), `num_var.txt` (variances), and `hittingTime.txt` (first hitting times).
- Renames and saves these outputs to files that encode the simulation parameters, for easy identification and downstream use. This naming structure is used in other analysis/scripts such as for entropy and coefficient of variation calculations.

### How to Use

1. **Requirements**
   - Libraries: `numpy` and `os`.
   - Compiled C simulator at `./generateTSAtrajectories/prog` that accepts command-line arguments and writes `num_mean.txt`, `num_var.txt`, and `hittingTime.txt` to the working directory.

2. **Edit Parameters** *(optional)*
   - Change the arrays `gamma_ar`, `D_ar`, `alpha_ar`, and `beta_ar` to specify the parameters you want to simulate.
   - Set simulation parameters like `fit_until_this_t`, `dt`, and `nrealiz` at the top of the script.

3. **Run the Script**
   ```sh
   python generateTSAEnsemble.py
   ```
   - Ensure you are in the correct working directory and that the C binary works as expected.

4. **Results**
   - The script generates output files for each parameter set, for example:
     - `mean_gamma10_D2_alpha10_beta10_N20000_dt500.txt`
     - `var_gamma10_D2_alpha10_beta10_N20000_dt500.txt`
     - `hittingtime_gamma10_D2_alpha10_beta10_N20000_dt500.txt`
   - These contain the means, variances, and first hitting times, respectively, for the simulated ensemble.

**In short**
- Loops over sets of (`gamma`, `D`, `alpha`, `beta`) parameters.
- Runs a C-based forward simulation for each parameter set.
- Saves mean, variance, and hitting time summary statistics to clearly-named text files for further analysis or use in inference pipelines.



## Stochastic Model Simulator and Alignment (`prog`)

This C simulation produces ensemble statistics (mean, variance, hitting time, covariance, and more) for a family of one-dimensional stochastic processes governed by power-law drift and noise. It outputs time series summaries for multiple independent realizations, with model parameters specified as command-line arguments.

### How to Compile

1. **Requirements**
   - GCC (or compatible C99 compiler)
   - Source files:  
     - `mainloop.c`, `init.c`, `randomnumbers.c`
   - Header files:  
     - `types.h`, `init.h`, `randomnumbers.h`
   - A `Makefile` (provided) is included for convenience.

2. **To Compile**
   ```sh
   make
   ```
   This produces an executable called `prog` in the current directory.  
   (Clean up object files using `make clean` if needed.)

### How to Use

1. **Required Arguments**

   The simulation is run via command line by supplying all required parameters in order (see below for parameter roles):

   ```
   ./prog x_start_sim nrealiz seed dt D x0_for_reverse total_time wfreq traFreq max_rtime x_upper_bound var_start_sim gamma alpha beta
   ```

   Example:
   ```
   ./prog 7 20000 12345 0.005 0.2 0 2000 50 1 8 1000 0 1.02 1.0 1.0
   ```

   Where:
   - `x_start_sim`   : Initial state for each trajectory
   - `nrealiz`       : Number of independent realizations (ensemble size)
   - `seed`          : Random number seed
   - `dt`            : Simulation time step
   - `D`             : Diffusion coefficient
   - `x0_for_reverse`: Absorbing boundary
   - `total_time`    : Total time for simulation
   - `wfreq`         : Covariance write frequency
   - `traFreq`       : Trajectory write frequency
   - `max_rtime`     : Maximum “reverse” time (observation window)
   - `x_upper_bound` : Reflecting upper boundary
   - `var_start_sim` : (Typically 0) Variation in initial condition
   - `gamma, alpha, beta`: Model parameters for drift and diffusion

2. **Outputs**

   Files generated in the current directory (per run):
   - `num_mean.txt`   – Time series of the ensemble mean
   - `num_var.txt`    – Ensemble variance
   - `num_cov.txt`    – Covariances (2D)
   - `num_skew.txt`   – Third moment (skewness)
   - `hittingTime.txt`– First-passage (hitting) times for each trajectory  
   - Optionally:  
     - `num_trj.txt` and/or `num_trj_fwd.txt` (trajectory samples)

   These can be renamed by downstream Python scripts based on input parameters for organized analysis.

**In short**
- `prog` simulates a chosen stochastic model for an ensemble of initial conditions and outputs summary statistics to text files.
- You can automate simulation sweeps over different parameter settings by calling the executable from Python (see previous Python example) and handling the output files programmatically.

**Troubleshooting**
- Ensure all required header/source files are present for compilation.
- If you encounter permissions or path issues, check that `prog` is executable (`chmod +x prog`).


